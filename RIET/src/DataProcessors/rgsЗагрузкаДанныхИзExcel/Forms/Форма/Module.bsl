
// { Процедуры вызываемые из формы обработки
&НаКлиенте
Процедура ЗагрузитьДанные(Команда)
	
	ПоказатьВопрос(
	Новый ОписаниеОповещения("LoadData", 
	ЭтотОбъект, ),
	"Выполнить заполнение данных из Excel?", 
	РежимДиалогаВопрос.ДаНет,
	60,
	КодВозвратаДиалога.Нет,
	,
	КодВозвратаДиалога.Нет);

КонецПроцедуры

&НаКлиенте
Процедура LoadData(Результат, Параметр) Экспорт 
	
	Если Результат = КодВозвратаДиалога.Нет Тогда
		Возврат;
	КонецЕсли;
	
	НастройкиДиалога = Новый Структура;
	НастройкиДиалога.Вставить("Фильтр", НСтр("ru = 'Файлы xlsx (*.xlsx)'") + "|*.xlsx" );
	НастройкиДиалога.Вставить("Rental", ЭтотОбъект);
	
	Оповещение = Новый ОписаниеОповещения("LoadFile", ЭтотОбъект);
	ОбменДаннымиКлиент.ВыбратьИПередатьФайлНаСервер(Оповещение, НастройкиДиалога, Новый УникальныйИдентификатор);
	
КонецПроцедуры

&НаКлиенте
Процедура LoadFile(Знач РезультатПомещенияФайлов, Знач ДополнительныеПараметры) Экспорт
	
	АдресФайла = РезультатПомещенияФайлов.Хранение;
	РасширениеФайла = "xlsx";
	
	ЗагрузитьДанныеНаСервере(АдресФайла, РасширениеФайла, ДополнительныеПараметры);
	
КонецПроцедуры

&НаСервере
Процедура ЗагрузитьДанныеНаСервере(АдресФайла, РасширениеФайла, ДополнительныеПараметры)

	Таблица = РеквизитФормыВЗначение("Объект").ЗагрузитьДанные(АдресФайла, РасширениеФайла, ДополнительныеПараметры);

КонецПроцедуры // ЗагрузитьДанныеНаСервере()

// } Процедуры вызываемые из формы обработки