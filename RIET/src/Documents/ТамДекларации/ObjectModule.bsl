
////////////////////////////////////////////////////////////////////////////
// ОБЪЯВЛЕНИЕ ПЕРЕМЕННЫХ МОДУЛЯ

Перем мУдалятьДвижения;


////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ДОКУМЕНТА

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	мУдалятьДвижения = НЕ ЭтоНовый();
	
	Если РежимЗаписи = РежимЗаписиДокумента.Проведение Тогда
		
		// Заголовок для сообщений об ошибках проведения.
		Заголовок = "Проведение документа ""Таможенная декларация"": ";
		
		// Проверить заполнение реквизитов шапки документа
		ПроверитьЗаполнениеШапки(Отказ, Заголовок);
		
		//Проверить заполнение табличной части Состав
		ПроверитьЗаполнениеТабличнойЧастиСостав(Отказ, Заголовок);
		
		//Проверить заполнение табличной части Состав детальный
		ПроверитьЗаполнениеТабличнойЧастиСоставДетальный(Отказ, Заголовок);
		
		//Проверить заполнение табличной части Платежи
		ПроверитьЗаполнениеТабличнойЧастиПлатежи(Отказ, Заголовок);
		
		//Проверить заполнение табличной части Документы и сертификаты
		ПроверитьЗаполнениеТабличнойЧастиДокументыИСертификаты(Отказ, Заголовок);
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	
	Если мУдалятьДвижения Тогда
		ОбщегоНазначения.УдалитьДвиженияРегистратора(ЭтотОбъект, Отказ,, Истина);
	КонецЕсли;
	
КонецПроцедуры

Процедура ОбработкаУдаленияПроведения(Отказ)
	
	ОбщегоНазначения.УдалитьДвиженияРегистратора(ЭтотОбъект, Отказ,, Истина);
	
КонецПроцедуры


////////////////////////////////////////////////////////////////////////////
// ПОДДЕРЖКА ПРОВЕДЕНИЯ ДОКУМЕНТА

Процедура ПроверитьЗаполнениеШапки(Отказ, Заголовок)
	
	// Сформируем структуру обязательных полей шапки документа
	СтруктураОбязательныхПолей = Новый Структура;
	СтруктураОбязательныхПолей.Вставить("ГТД");
		
	// Проверим правильность заполнения шапки документа
	ОбщегоНазначения.ПроверитьЗаполнениеШапкиДокумента(ЭтотОбъект, СтруктураОбязательныхПолей, Отказ, Заголовок);
	
КонецПроцедуры

Процедура ПроверитьЗаполнениеТабличнойЧастиСостав(Отказ, Заголовок)
	
	Если Состав.Итог("ТаможеннаяСтоимость") <> ОбщаяТамСтоимость Тогда
		
		ОбщегоНазначения.СообщитьОбОшибке("Общая таможенная стоимость в табличной части ""Состав"" не совпадает с шапкой документа!", Отказ, Заголовок);
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ПроверитьЗаполнениеТабличнойЧастиСоставДетальный(Отказ, Заголовок)
	
	//
	
КонецПроцедуры

Процедура ПроверитьЗаполнениеТабличнойЧастиПлатежи(Отказ, Заголовок)
	
	//
	
КонецПроцедуры

Процедура ПроверитьЗаполнениеТабличнойЧастиДокументыИСертификаты(Отказ, Заголовок)
	
	//
	
КонецПроцедуры

