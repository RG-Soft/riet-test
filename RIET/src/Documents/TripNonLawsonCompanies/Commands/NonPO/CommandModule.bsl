
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ClosedTrips = Истина;
	
	Для Каждого Док Из ПараметрКоманды Цикл 
		
		Stage = ОпределитьStage(Док);
		
		Если Stage <> ПредопределенноеЗначение("Перечисление.TripNonLawsonCompaniesStages.Closed") Тогда
			
			ClosedTrips = Ложь;

			Если РГСофтСерверПовтИспСеанс.ПолучитьПараметрСеансаShowNamesAndDescriptionsRUS()  Тогда 
				Сообщить("Текущий статус '"+ СокрЛП(Док) +"': '"+ СокрЛП(Stage) +"'. 
				|Заявка может быть распечатана только после закрытия поставки!");
			Иначе 
				Сообщить("Current stage of '"+ СокрЛП(Док) +"': '"+ СокрЛП(Stage) +"'.  
				|Non-PO can be printed only after trip was closed!");
			КонецЕсли;
			   		
		КонецЕсли;
	
	КонецЦикла;
	
	Если ClosedTrips Тогда 
		
		УправлениеПечатьюКлиент.ВыполнитьКомандуПечати(
				"Документ.TripNonLawsonCompanies", 
				"NonPO", 
				ПараметрКоманды,
				ПараметрыВыполненияКоманды);
				
	КонецЕсли;		

КонецПроцедуры

&НаСервере
Функция ОпределитьStage(Trip)
	
	Возврат РегистрыСведений.StagesOfTripsNonLawsonCompanies.ОпределитьStage(Trip);	
	
КонецФункции
	
