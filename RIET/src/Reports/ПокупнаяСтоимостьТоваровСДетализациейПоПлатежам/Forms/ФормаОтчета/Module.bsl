
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("СтруктураНастройки") Тогда
		
		СтруктураНастройки = Параметры.СтруктураНастройки;
		Если СтруктураНастройки.Имя = "ОткрытиеИзBatchOfCustomsFiles" Тогда
			НастроитьДляОткрытияИзBatchOfCustomsFiles(СтруктураНастройки);
		КонецЕсли;
		
	КонецЕсли;
		
КонецПроцедуры

&НаСервере
Процедура НастроитьДляОткрытияИзBatchOfCustomsFiles(СтруктураНастройки)
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("BatchOfCustomsFiles", СтруктураНастройки.BatchOfCustomsFiles);
	Запрос.Текст =
		"ВЫБРАТЬ
		|	BatchesOfCustomsFilesCustomsFiles.CCD КАК CustomsFile
		|ИЗ
		|	Документ.BatchesOfCustomsFiles.CCDs КАК BatchesOfCustomsFilesCustomsFiles
		|ГДЕ
		|	BatchesOfCustomsFilesCustomsFiles.Ссылка = &BatchOfCustomsFiles";
		
	CustomsFiles = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("CustomsFile");
	
	Параметры.Отбор.Вставить("CCD", CustomsFiles);
	
КонецПроцедуры

&НаСервере
Процедура ПриЗагрузкеПользовательскихНастроекНаСервере(Настройки)
	
	// Если установлены дополнительные отборы - то пользовательские настройки надо снять
	Если Параметры.Свойство("Отбор") И Параметры.Отбор.Количество() Тогда	
		CustomsСервер.ОтменитьИспользованиеПараметровИОтборовВПользовательскихНастройках(Отчет.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы);		
	КонецЕсли;
	
КонецПроцедуры


