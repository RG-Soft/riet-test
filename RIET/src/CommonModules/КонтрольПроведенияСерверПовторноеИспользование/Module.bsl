
#Область ИнтерфейсМодуля

Функция ПолучитьПрокси() Экспорт
	
	ПараметрыПодключения = КонтрольПроведенияСервер.ПолучитьПараметрыПодключения();
	
	Если ПараметрыПодключения = Неопределено Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Определение = Новый WSОпределения(ПараметрыПодключения.АдресПодключения + "/ws/" + НРег(ПараметрыПодключения.ИмяWebСервиса) + ".1cws?wsdl", ПараметрыПодключения.ИмяПользователя, ПараметрыПодключения.Пароль);
	
	Попытка
		Прокси = Новый WSПрокси(Определение, ПараметрыПодключения.ИмяWebСервиса, ПараметрыПодключения.ИмяWebСервиса, ПараметрыПодключения.ИмяWebСервиса+"Soap12");
		Прокси.Пользователь = ПараметрыПодключения.ИмяПользователя;
		Прокси.Пароль 		= ПараметрыПодключения.Пароль;
	
		Возврат Прокси;
	Исключение
		Возврат Неопределено;
	КонецПопытки;
	
КонецФункции

Функция ПолучитьСписокИННКонтролируемыхКомпаний() Экспорт
	
	Прокси = ПолучитьПрокси();
	
	Если Прокси = Неопределено Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Результат = Прокси.GetDomainOfControlledOrganizations();
	Возврат СериализаторXDTO.ПрочитатьXDTO(Результат);
	
КонецФункции

#КонецОбласти


